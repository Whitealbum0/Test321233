# üîê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ OAuth2 —Å Google –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π

## üìã –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ OAuth2 –¥–ª—è e-commerce –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### üéØ **–ß—Ç–æ –±—ã–ª–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**

1. **OAuth2 –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Å Google**
2. **JWT —Ç–æ–∫–µ–Ω—ã –¥–ª—è —Å–µ—Å—Å–∏–π**
3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**
4. **–°–≤—è–∑—ã–≤–∞–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–æ–≤**
5. **–ó–∞—â–∏—â–µ–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã**

---

## üöÄ **–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç:**

### **1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:**

```bash
# Backend
cd backend
pip install -r requirements_oauth2.txt

# Frontend
cd frontend
npm install
```

### **2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:**

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ OAuth2
python setup_oauth2.py
```

### **3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Google OAuth2:**

#### **A. –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –≤ Google Cloud Console:**

1. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Google Cloud Console**: https://console.cloud.google.com/
2. **–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç** –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π
3. **–í–∫–ª—é—á–∏—Ç–µ Google+ API**:
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "APIs & Services" ‚Üí "Library"
   - –ù–∞–π–¥–∏—Ç–µ "Google+ API"
   - –ù–∞–∂–º–∏—Ç–µ "Enable"

#### **B. –°–æ–∑–¥–∞–Ω–∏–µ OAuth2 Client ID:**

1. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "Credentials"**: APIs & Services ‚Üí Credentials
2. **–ù–∞–∂–º–∏—Ç–µ "Create Credentials"** ‚Üí "OAuth 2.0 Client ID"
3. **–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø**: "Web application"
4. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ redirect URI**:
   ```
   Authorized redirect URIs:
   http://localhost:8001/api/auth/google/callback
   ```
5. **–°–∫–∞—á–∞–π—Ç–µ credentials** –∏–ª–∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ Client ID –∏ Client Secret

#### **C. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è:**

–û–±–Ω–æ–≤–∏—Ç–µ `backend/.env`:
```env
# OAuth2 Configuration
GOOGLE_CLIENT_ID=–≤–∞—à-google-client-id
GOOGLE_CLIENT_SECRET=–≤–∞—à-google-client-secret
GOOGLE_REDIRECT_URI=http://localhost:8001/api/auth/google/callback

# JWT Configuration
JWT_SECRET_KEY=–≤–∞—à-—Å—É–ø–µ—Ä-—Å–µ–∫—Ä–µ—Ç–Ω—ã–π-–∫–ª—é—á

# Database Configuration
MONGO_URL=mongodb://localhost:27017
DB_NAME=ecommerce_local

# Frontend URL
FRONTEND_URL=http://localhost:3000
```

### **4. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:**

```bash
# Backend (–≤ –ø–µ—Ä–≤–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)
cd backend
python server_oauth.py

# Frontend (–≤–æ –≤—Ç–æ—Ä–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)
cd frontend
npm start
```

### **5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**

- –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:3000
- –ù–∞–∂–º–∏—Ç–µ "–í–æ–π—Ç–∏"
- –í—ã–±–µ—Ä–∏—Ç–µ "–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Google"
- –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å —Å –ø–æ–º–æ—â—å—é Google –∞–∫–∫–∞—É–Ω—Ç–∞

---

## üîß **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ OAuth2 —Å–∏—Å—Ç–µ–º—ã:**

### **Backend —Ñ–∞–π–ª—ã:**
- `oauth_auth.py` - –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ OAuth2
- `server_oauth.py` - FastAPI —Å–µ—Ä–≤–µ—Ä —Å OAuth2
- `requirements_oauth2.txt` - –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### **Frontend —Ñ–∞–π–ª—ã:**
- `OAuth2AuthContext.js` - Context –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- `GoogleLoginButton.js` - –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –≤—Ö–æ–¥–∞
- `DesktopNavbarOAuth2.js` - –î–µ—Å–∫—Ç–æ–ø–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è
- `MobileNavbarOAuth2.js` - –ú–æ–±–∏–ª—å–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è

### **–û—Å–Ω–æ–≤–Ω—ã–µ endpoints:**
- `GET /api/auth/google` - –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ Google
- `GET /api/auth/google/callback` - Callback –æ—Ç Google
- `POST /api/auth/google/mobile` - –ú–æ–±–∏–ª—å–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- `GET /api/auth/me` - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
- `POST /api/auth/logout` - –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã

---

## üõ°Ô∏è **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**

### **JWT —Ç–æ–∫–µ–Ω—ã:**
- –í—Ä–µ–º—è –∂–∏–∑–Ω–∏: 30 –º–∏–Ω—É—Ç
- –ê–ª–≥–æ—Ä–∏—Ç–º: HS256
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

### **–ó–∞—â–∏—â–µ–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã:**
- `get_current_user()` - –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- `get_current_user_optional()` - –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- `get_admin_user()` - –¢–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤

### **–î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
- Email (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- –ò–º—è (–∏–∑ Google)
- –§–æ—Ç–æ –ø—Ä–æ—Ñ–∏–ª—è (–∏–∑ Google)
- –†–æ–ª—å (user/admin)
- –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è

---

## üìä **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**

### **–†–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
- **user** - –û–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- **admin** - –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä

### **–ê–¥–º–∏–Ω—Å–∫–∏–µ endpoints:**
- `GET /api/admin/users` - –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `GET /api/admin/stats` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### **–°–æ–∑–¥–∞–Ω–∏–µ –∞–¥–º–∏–Ω–∞:**
```python
# –í—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ MongoDB
db.users.update_one(
    {"email": "admin@example.com"},
    {"$set": {"role": "admin"}}
)
```

---

## üîç **–û—Ç–ª–∞–¥–∫–∞:**

### **–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
cat backend/.env

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ MongoDB
mongo --eval "db.adminCommand('ping')"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ Google OAuth2
curl http://localhost:8001/api/auth/google
```

### **–õ–æ–≥–∏:**
- Backend: –ö–æ–Ω—Å–æ–ª—å uvicorn
- Frontend: –ö–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞
- MongoDB: –õ–æ–≥–∏ MongoDB

### **–¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏:**
1. **–ù–µ–≤–µ—Ä–Ω—ã–π Client ID** - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `.env`
2. **–ù–µ–≤–µ—Ä–Ω—ã–π Redirect URI** - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ Google Console
3. **MongoDB –Ω–µ –∑–∞–ø—É—â–µ–Ω** - –ó–∞–ø—É—Å—Ç–∏—Ç–µ MongoDB
4. **–ü–æ—Ä—Ç –∑–∞–Ω—è—Ç** - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥—Ä—É–≥–æ–π –ø–æ—Ä—Ç

---

## üéâ **–ì–æ—Ç–æ–≤–æ!**

–¢–µ–ø–µ—Ä—å —É –≤–∞—Å –µ—Å—Ç—å –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è OAuth2 –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:

‚úÖ **–í—Ö–æ–¥ —á–µ—Ä–µ–∑ Google**
‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**
‚úÖ **JWT —Ç–æ–∫–µ–Ω—ã**
‚úÖ **–ó–∞—â–∏—â–µ–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã**
‚úÖ **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**
‚úÖ **–ú–æ–±–∏–ª—å–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞**

### **–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
1. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ production –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
2. –î–æ–±–∞–≤—å—Ç–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ backup –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
4. –î–æ–±–∞–≤—å—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

**–£–¥–∞—á–∏ –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ OAuth2 –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏! üöÄ**